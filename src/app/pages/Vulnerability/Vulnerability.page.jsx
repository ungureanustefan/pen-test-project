// Import: Packages
// eslint-disable-next-line no-unused-vars
import React from "react";
import { useLocation } from "react-router";

// Import: Components
import { Button } from "../../components";

// Import: Elements
import {
  ArrayContainer,
  ArrayItem,
  Label,
  LabelValueContainer,
  ListContainer,
  ListItem,
  PageHeaderContainer,
  Title,
  Value,
  VulnerabilityContainer,
  Wrapper,
} from "./Vulnerability.elements";

// Import: Custom Hooks

import useVulnerability from "./useVulnerability";

// Page: Vulnerability
export default function Vulnerability() {
  const location = useLocation();
  const vulnerabilityData = location?.state;
  const {
    additional_affected_asset_fields,
    category,
    created_at,
    cves,
    cvss3_score,
    cvss_score,
    description,
    exploit_available,
    external_links,
    from,
    name,
    remediation,
    severity,
    updated_at,
  } = vulnerabilityData;

  const { handleClickBack } = useVulnerability();

  return (
    <VulnerabilityContainer data-testid="vulnerability-page">
      <PageHeaderContainer>
        <h1>Vulnerability</h1>
        <Button handleClick={() => handleClickBack(from)}>Back</Button>
      </PageHeaderContainer>
      <Wrapper>
        <ListContainer>
          <ListItem>
            <Title>DETAILS</Title>
            <LabelValueContainer>
              <Label>Name:</Label>
              <Value>{name}</Value>
            </LabelValueContainer>
            <LabelValueContainer>
              <Label>Severity:</Label>
              <Value>{severity}</Value>
            </LabelValueContainer>
            <LabelValueContainer>
              <Label>Description:</Label>
              <Value>{description}</Value>
            </LabelValueContainer>
            <LabelValueContainer>
              <Label>Remediation:</Label>
              <Value>{remediation}</Value>
            </LabelValueContainer>
            <LabelValueContainer>
              <Label>Category:</Label>
              <Value>{category}</Value>
            </LabelValueContainer>

            <LabelValueContainer>
              <Label>CVSS3 Score:</Label>
              <Value>{cvss3_score}</Value>
            </LabelValueContainer>
            <LabelValueContainer>
              <Label>CVSS Score:</Label>
              <Value>{cvss_score}</Value>
            </LabelValueContainer>

            <LabelValueContainer>
              <Label>Exploit Available:</Label>
              <Value>{exploit_available}</Value>
            </LabelValueContainer>
            <LabelValueContainer>
              <Label>Created At:</Label>
              <Value>{created_at}</Value>
            </LabelValueContainer>
            <LabelValueContainer>
              <Label>Updated At:</Label>
              <Value>{updated_at}</Value>
            </LabelValueContainer>
          </ListItem>

          <ListItem>
            <Title>Additional Affected Asset Fields</Title>
            <ArrayContainer>
              {additional_affected_asset_fields.map((item, index) => (
                <ArrayItem key={index}>{item}</ArrayItem>
              ))}
            </ArrayContainer>
          </ListItem>

          <ListItem>
            <Title>External Links</Title>
            <ArrayContainer>
              {external_links.map((link, index) => (
                <ArrayItem key={index}>
                  <a href={link}>{link.url}</a>
                </ArrayItem>
              ))}
            </ArrayContainer>
          </ListItem>

          <ListItem>
            <Title>CVEs</Title>
            <ArrayContainer>
              {cves.map((cve, index) => (
                <ArrayItem key={index}>{cve}</ArrayItem>
              ))}
            </ArrayContainer>
          </ListItem>
        </ListContainer>
      </Wrapper>
    </VulnerabilityContainer>
  );
}
